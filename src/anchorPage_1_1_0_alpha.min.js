/**
 *AnchorPageJS Version 1.1.0 Alpha
 *Author: HerrMutig
 *License: MIT
 */
(function($){$.fn.anchorPage=function(options){var settings=$.extend({startMargin:150,endMargin:150,duration:2000,waitingtime:200,easing:"swing"},options);var posObjArr=[];var lastMouseScroll;var currentPos;var maxPos;var minPos;var lockAnimation;var wasScrollFiredBefore;var movedByWheel;var touchScreenStartYPos;var touchScreenEndYPos;var touchDirection;var movedByTouch;var windowCoordsAfterTouchMove;posObjArr=$(this).length>0?$(this):null;maxPos=posObjArr.length-1;minPos=0;lockAnimation=!1;function getScrollDirection(event)
{if(event.originalEvent.deltaY===undefined){return lastMouseScroll}else if(event.originalEvent.deltaY<0){lastMouseScroll="up";return lastMouseScroll}else if(event.originalEvent.deltaY>0){lastMouseScroll="down";return lastMouseScroll}}
function getCurrentPosition(){currentPos=0;for(var i=0;i<posObjArr.length;i++){if($(window).scrollTop()>=posObjArr[i].offsetTop){currentPos=i}}
return currentPos}
function allowMoving(event){if(movedByWheel){if(minPos===getCurrentPosition()&&getScrollDirection(event)==="up"||maxPos===getCurrentPosition()&&getScrollDirection(event)==="down"){return!0}
if($(window).scrollTop()>=posObjArr[maxPos].offsetTop+settings.endMargin&&getScrollDirection(event)==="up"){return!0}
if($(window).scrollTop()<=posObjArr[minPos].offsetTop-settings.startMargin&&getScrollDirection(event)==="down"){return!0}}
if(movedByTouch){if(minPos===getCurrentPosition()&&getTouchDirection()==="down"||maxPos===getCurrentPosition()&&getTouchDirection(event)==="up"){console.log("ALLOWED");return!0}
if($(window).scrollTop()<=posObjArr[minPos].offsetTop-settings.startMargin&&getTouchDirection(event)==="up"){return!0}
if($(window).scrollTop()>=posObjArr[maxPos].offsetTop+settings.endMargin&&getTouchDirection(event)==="down"){return!0}}
return!1}
function animateWindow(position){$("html, body").animate({scrollTop:position},{start:animateOnStart,complete:animateOnComplete,duration:settings.duration,easing:settings.easing})}
function scrollToAnchor(restriction){if(lockAnimation===!0)
return;var scrollToAnchor=getCurrentPosition();console.log(scrollToAnchor);if(restriction==="next"){if($(window).scrollTop()<posObjArr[minPos].offsetTop)
{scrollToAnchor=getCurrentPosition()-1}
animateWindow(posObjArr[scrollToAnchor+1].offsetTop);console.log(scrollToAnchor)}else if(restriction==="prev"){if($(window).scrollTop()>posObjArr[maxPos].offsetTop)
{scrollToAnchor=getCurrentPosition()+1}
animateWindow(posObjArr[scrollToAnchor-1].offsetTop)}
return!1}
function animateOnComplete(){setTimeout(function(){lockAnimation=!1},settings.waitingtime)}
function animateOnStart(){lockAnimation=!0}
function setTouchDirection(){if(touchScreenStartYPos>touchScreenEndYPos){touchDirection="up"}else if(touchScreenStartYPos<touchScreenEndYPos){touchDirection="down"}}
function getTouchDirection(deletion=!1){var temp=touchDirection!==undefined?touchDirection:null;if(deletion===!0)
{touchDirection=null}
return temp}
function EventScrollToSection(e){movedByWheel=!0;movedByTouch=!1;if(allowMoving(e)){return}
e.preventDefault();if(getScrollDirection(e)==="up"){scrollToAnchor("prev")}else if(getScrollDirection(e)==="down"){scrollToAnchor("next")}}
function blockOverflowedMouseScrolling(event){if(!allowMoving(event)&&wasScrollFiredBefore===!1){if(getCurrentPosition()===minPos){$(window).scrollTop(posObjArr[minPos].offsetTop-settings.startMargin)}else if(getCurrentPosition()===maxPos){$(window).scrollTop(posObjArr[maxPos].offsetTop+settings.endMargin)}
wasScrollFiredBefore=!0}else if(allowMoving(event)){wasScrollFiredBefore=!1}}
function blockOverflowedTouchScrolling(event){if(!allowMoving(event)&&wasScrollFiredBefore===!1)
{if(getCurrentPosition()===minPos){$(window).scrollTop(posObjArr[minPos].offsetTop-settings.startMargin)}else if(getCurrentPosition()===maxPos){$(window).scrollTop(posObjArr[maxPos].offsetTop+settings.endMargin)}
wasScrollFiredBefore=!0}
else if(allowMoving(event))
{wasScrollFiredBefore=!1}}
function EventScrollBlock(e){if(movedByWheel===!0){blockOverflowedMouseScrolling(e)}
if(movedByTouch===!0){blockOverflowedTouchScrolling(e)}}
function EventTouchStart(e){touchScreenStartYPos=e.touches[0].screenY;movedByWheel=!1;movedByTouch=!0}
function EventTouchMove(e){if(!allowMoving(e)){e.preventDefault()}
touchScreenEndYPos=e.touches[0].screenY;setTouchDirection()}
function EventTouchToSection(e){console.log(getTouchDirection());windowCoordsAfterTouchMove=$(window).scrollTop();if(allowMoving(e)){getTouchDirection(!0);return}
if(getTouchDirection()==="down")
{scrollToAnchor("prev")}
else if(getTouchDirection()==="up")
{scrollToAnchor("next")}
getTouchDirection(!0)}
$(window).on("wheel",EventScrollToSection);$(window).on("scroll",EventScrollBlock);window.addEventListener("touchstart",EventTouchStart);window.addEventListener("touchmove",EventTouchMove,{passive:!1,cancelable:!0,cancelBubble:!0});$(window).on("touchend",EventTouchToSection)}}(jQuery));
